# LONI API â€” Implementation Status (as of 2026-01-12)

This checklist is generated by comparing the API spec in `API-DOCUMENTATION.md` with what currently exists in the codebase.

## Legend

- **âœ… Implemented (Client wired)**: there is a service/repository calling the endpoint.
- **ğŸŸ¨ Stubbed / UI-only**: screen exists but uses mock data or a placeholder service.
- **âŒ Missing**: no client code found calling the endpoint.
- **â€” N/A**: not applicable for that app.

Apps:
- **Consumer app**: `loni_backup/` (package: `loni_africa`)
- **Admin app**: `admin/`

---

## 1) Authentication

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| POST `/v1/login` (legacy/simplified) | âŒ | âŒ | â€” |
| POST `/v1/auth/signup` | âœ… | â€” | `loni_backup/lib/features/auth/data/services/auth_service.dart` |
| POST `/v1/auth/login` | âœ… | âœ… | Consumer: `loni_backup/lib/features/auth/data/services/auth_service.dart` â€¢ Admin: `admin/lib/features/auth/data/services/admin_auth_service.dart` |
| POST `/v1/auth/partner/login` | âŒ | âŒ | â€” |
| GET `/v1/auth/jwks` | âŒ | âŒ | â€” |
| POST `/v1/auth/token/refresh` | âœ… | âŒ | `loni_backup/lib/features/auth/data/services/auth_token_refresh_service.dart` + interceptor wiring in `loni_backup/lib/core/network/api_client.dart` |
| POST `/v1/auth/otp/send` | âŒ | âŒ | â€” |
| POST `/v1/auth/password/reset/request` | âœ… | âŒ | `loni_backup/lib/features/auth/data/services/auth_service.dart` |
| POST `/v1/auth/password/reset/confirm` | âœ… | âŒ | `loni_backup/lib/features/auth/data/services/auth_service.dart` |
| POST `/v1/auth/password/change` | âŒ | âŒ | â€” |
| GET `/v1/auth/profile` | âœ… | âŒ | `loni_backup/lib/features/profile/data/data_sources/profile_remote_data_source.dart` |
| PATCH `/v1/auth/profile` | âœ… | âŒ | `loni_backup/lib/features/profile/data/data_sources/profile_remote_data_source.dart` |
| GET `/v1/auth/preferences` | âŒ | âŒ | â€” |
| PUT `/v1/auth/preferences` | âŒ | âŒ | â€” |
| GET `/v1/auth/consents` | âŒ | âŒ | â€” |
| PATCH `/v1/auth/consents` | âŒ | âŒ | â€” |
| GET `/v1/auth/parental-controls` | âŒ | âŒ | â€” |
| PATCH `/v1/auth/parental-controls` | âŒ | âŒ | â€” |
| GET `/v1/auth/sessions` | âŒ | âŒ | â€” |
| DELETE `/v1/auth/sessions/:id` | âŒ | âŒ | â€” |
| GET `/v1/auth/devices` | âŒ | âŒ | â€” |
| POST `/v1/auth/devices` | âŒ | âŒ | â€” |
| DELETE `/v1/auth/devices/:id` | âŒ | âŒ | â€” |
| GET `/v1/auth/purchases` | âŒ | âŒ | â€” |
| POST `/v1/auth/privacy/export` | âŒ | âŒ | â€” |
| POST `/v1/auth/privacy/delete` | âŒ | âŒ | â€” |

Notes:
- Consumer app includes automatic refresh-token handling on 401s (single-flight) and updates the access token in the API client.

---

## 2) Books & Catalog

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/books` | âœ… | â€” | `loni_backup/lib/features/discovery/data/services/discovery_api_service.dart` |
| GET `/v1/search` | âœ… | â€” | `loni_backup/lib/features/discovery/data/services/discovery_api_service.dart` |
| GET `/v1/books/:id` | âœ… | â€” | `loni_backup/lib/features/discovery/data/services/discovery_api_service.dart` |
| GET `/v1/recommendations` | âœ… | â€” | `loni_backup/lib/features/discovery/data/services/discovery_api_service.dart` |
| GET `/v1/app/home` | âœ… | â€” | `loni_backup/lib/features/discovery/data/services/discovery_api_service.dart` |
| POST `/v1/articles` | âŒ | âŒ | â€” |
| GET `/v1/canonical/books` | âŒ | âŒ | â€” |
| GET `/v1/canonical/books/:id` | âŒ | âŒ | â€” |
| GET `/v1/canonical/books/by-catalog-item/:catalogItemId` | âŒ | âŒ | â€” |
| GET `/v1/markets/region-presets` | âŒ | âŒ | â€” |

Notes:
- `loni_backup/lib/features/discovery/data/services/search_service.dart` is mock data and is not wired to `/v1/search` (the real search is implemented via `DiscoveryApiService.searchBooks`).

---

## 3) Orders

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/orders` | âœ… | â€” | `loni_backup/lib/features/library/data/services/library_api_service.dart` |
| POST `/v1/orders` | âœ… | â€” | `loni_backup/lib/features/commerce/data/services/commerce_api_service.dart` |
| GET `/v1/orders/:orderId` | âœ… | â€” | `loni_backup/lib/features/library/data/services/library_api_service.dart` |
| POST `/v1/orders/:orderId/pay` | âœ… | â€” | `loni_backup/lib/features/commerce/data/services/commerce_api_service.dart` |
| POST `/v1/orders/:orderId/refund` | âŒ | âŒ | â€” |
| POST `/v1/orders/:orderId/cancel-backorder` | âŒ | âŒ | â€” |
| PUT `/v1/orders/:orderId/shipping-address` | âŒ | âŒ | â€” |
| GET `/v1/tracking/:trackingCode` (public) | âŒ | âŒ | â€” |
| POST `/v1/payments/webhook/:provider` | â€” | â€” | Server-side (not a client concern) |

---

## 4) Publisher

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/publisher/profile` | âŒ | âŒ | â€” |
| PATCH `/v1/publisher/profile` | âŒ | âŒ | â€” |
| POST `/v1/publisher/upload` | âŒ | âŒ | â€” |
| GET `/v1/publisher/uploads/:uploadId` | âŒ | âŒ | â€” |
| GET `/v1/publisher/uploads/:uploadId/epub` | âŒ | âŒ | â€” |
| GET `/v1/publisher/uploads/:uploadId/resumable/status` | âŒ | âŒ | â€” |
| POST `/v1/publisher/uploads/:uploadId/resumable/parts` | âŒ | âŒ | â€” |
| POST `/v1/publisher/uploads/:uploadId/resumable/complete` | âŒ | âŒ | â€” |
| GET `/v1/publisher/submissions` | âŒ | âŒ | â€” |
| POST `/v1/publisher/submissions` | âŒ | âŒ | â€” |
| GET `/v1/publisher/submissions/:submissionId` | âŒ | âŒ | â€” |
| PATCH `/v1/publisher/submissions/:submissionId` | âŒ | âŒ | â€” |
| DELETE `/v1/publisher/submissions/:submissionId` | âŒ | âŒ | â€” |
| POST `/v1/publisher/submissions/:submissionId/promote` | âŒ | âŒ | â€” |
| GET `/v1/publisher/dashboard` | âŒ | âŒ | â€” |
| GET `/v1/publisher/print-partners` | âŒ | âŒ | â€” |
| GET `/v1/publisher/royalties` | âŒ | âŒ | â€” |
| GET `/v1/publisher/royalties/statements` | âŒ | âŒ | â€” |
| GET `/v1/publisher/royalties/schedule` | âŒ | âŒ | â€” |
| POST `/v1/publisher/earnings/estimate` | âŒ | âŒ | â€” |
| GET `/v1/publisher/analytics` | âŒ | âŒ | â€” |
| GET `/v1/publisher/notifications` | âŒ | âŒ | â€” |
| POST `/v1/publisher/notifications/:notificationId/read` | âŒ | âŒ | â€” |
| POST `/v1/publisher/notifications/read-all` | âŒ | âŒ | â€” |

---

## 5) Partner (Logistics)

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/partners/orders` | âŒ | âŒ | â€” |
| GET `/v1/partners/orders/:id` | âŒ | âŒ | â€” |
| POST `/v1/partners/orders/:id/status` | âŒ | âŒ | â€” |
| POST `/v1/partners/orders/:id/proof` | âŒ | âŒ | â€” |

---

## 6) Content & DRM

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/content/:fileId/chunks/:chunkId` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| GET `/v1/content/:fileId/sample` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| POST `/v1/content/:fileId/preview-token` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| GET `/v1/content/policy` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| GET `/v1/content/offline/policy` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| GET `/v1/content/offline-telemetry/:deviceId` | âŒ | âŒ | â€” |
| POST `/v1/content/offline-requests` | âŒ | âŒ | â€” |
| GET `/v1/content/offline-requests` | âŒ | âŒ | â€” |
| POST `/v1/content/offline-requests/:id/acknowledge` | âŒ | âŒ | â€” |
| GET `/v1/content/offline/telemetry` | âŒ | âŒ | â€” |
| GET `/v1/drm/licenses/:bookId` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/drm_api_service.dart` |

---

## 7) Analytics

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/analytics/reading-states` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| POST `/v1/analytics/reading-states` | âœ… | âŒ | `loni_backup/lib/features/reading/data/services/reading_api_service.dart` |
| GET `/v1/analytics/highlights` | âŒ | âŒ | â€” |
| POST `/v1/analytics/highlights` | âŒ | âŒ | â€” |
| POST `/v1/analytics/reading-sessions` | âŒ | âŒ | â€” |
| GET `/v1/analytics/reading-sessions` | âŒ | âŒ | â€” |
| GET `/v1/admin/analytics/reading-report` | âŒ | âŒ | â€” |

---

## 8) Notifications

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/notifications` | âœ… | âŒ | `loni_backup/lib/features/community/data/services/notifications_api_service.dart` + `loni_backup/lib/features/community/presentation/screens/notifications_screen.dart` |
| POST `/v1/notifications/:notificationId/read` | âœ… | âŒ | `loni_backup/lib/features/community/data/services/notifications_api_service.dart` |
| POST `/v1/notifications/read-all` | âœ… | âŒ | `loni_backup/lib/features/community/data/services/notifications_api_service.dart` |

---

## 9) Admin

Most admin endpoints are implemented in the **admin app** (not the consumer app).

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/admin/health` | â€” | âœ… | `admin/lib/core/network/admin_api.dart` |
| GET `/v1/admin/overview` | â€” | âœ… | `admin/lib/core/network/admin_api.dart` |
| GET `/v1/admin/summary` | â€” | âœ… | `admin/lib/core/network/admin_api.dart` |
| GET `/v1/admin/audit` | â€” | âœ… | `admin/lib/core/network/admin_api.dart` |
| GET `/v1/admin/system/features` | â€” | âŒ | â€” |
| GET `/v1/admin/system/roles` | â€” | âŒ | â€” |
| GET `/v1/admin/system/settings` | â€” | âŒ | â€” |
| GET `/v1/admin/system/status` | â€” | âœ… | `admin/lib/core/network/admin_api.dart` |
| GET `/v1/admin/users` | â€” | âœ… | `admin/lib/features/users/data/services/admin_user_service.dart` |
| GET `/v1/admin/users/:userId` | â€” | âœ… | `admin/lib/features/users/data/services/admin_user_service.dart` |
| PATCH `/v1/admin/users/:userId` | â€” | âœ… | `admin/lib/features/users/data/services/admin_user_service.dart` |
| POST `/v1/admin/users/:userId/suspend` | â€” | âœ… | `admin/lib/features/users/data/services/admin_user_service.dart` |
| POST `/v1/admin/users/:userId/activate` | â€” | âœ… | `admin/lib/features/users/data/services/admin_user_service.dart` |
| POST `/v1/admin/users/:userId/soft-delete` | â€” | âŒ | â€” |
| GET `/v1/admin/moderation/tasks` | â€” | âœ… | `admin/lib/features/moderation/data/services/admin_moderation_service.dart` |
| GET `/v1/admin/moderation/tasks/:taskId` | â€” | âœ… | `admin/lib/features/moderation/data/services/admin_moderation_service.dart` |
| GET `/v1/admin/moderation/tasks/:taskId/events` | â€” | âœ… | `admin/lib/features/moderation/data/services/admin_moderation_service.dart` |
| GET `/v1/admin/moderation/tasks/:taskId/epub` | â€” | âŒ | â€” |
| PATCH `/v1/admin/moderation/tasks/:taskId` | â€” | âœ… | `admin/lib/features/moderation/data/services/admin_moderation_service.dart` |
| GET `/v1/admin/refunds` | â€” | âŒ | â€” |
| PATCH `/v1/admin/refunds/:refundId` | â€” | âŒ | â€” |
| GET `/v1/admin/orders` | â€” | âœ… | `admin/lib/features/orders/data/services/admin_order_service.dart` |
| GET `/v1/admin/orders/kpis` | â€” | âœ… | `admin/lib/features/orders/data/services/admin_order_service.dart` |
| GET `/v1/admin/orders/:orderId` | â€” | âœ… | `admin/lib/features/orders/data/services/admin_order_service.dart` |
| POST `/v1/admin/orders/:orderId/cancel` | â€” | âœ… | `admin/lib/features/orders/data/services/admin_order_service.dart` |
| POST `/v1/admin/orders/:orderId/escalate` | â€” | âœ… | `admin/lib/features/orders/data/services/admin_order_service.dart` |
| POST `/v1/admin/orders/:orderId/reassign-printer` | â€” | âŒ | â€” |
| GET `/v1/admin/catalog/flags` | â€” | âœ… | `admin/lib/features/catalog/data/services/admin_catalog_service.dart` |
| POST `/v1/admin/catalog/flags/:flagId/status` | â€” | âœ… | `admin/lib/features/catalog/data/services/admin_catalog_service.dart` |
| GET `/v1/admin/catalog/items/:itemId/compliance` | â€” | âœ… | `admin/lib/features/catalog/data/services/admin_catalog_service.dart` |
| POST `/v1/admin/catalog/items/:itemId/compliance` | â€” | âœ… | `admin/lib/features/catalog/data/services/admin_catalog_service.dart` |
| GET `/v1/admin/catalog/compliance` | â€” | âœ… | `admin/lib/features/catalog/data/services/admin_catalog_service.dart` |
| POST `/v1/admin/catalog/compliance` | â€” | âŒ | â€” |
| PATCH `/v1/admin/catalog/compliance/:ruleId` | â€” | âŒ | â€” |
| DELETE `/v1/admin/catalog/compliance/:ruleId` | â€” | âŒ | â€” |
| POST `/v1/admin/catalog/compliance/simulate` | â€” | âŒ | â€” |
| GET `/v1/admin/catalog/featured` | â€” | âŒ | â€” |
| POST `/v1/admin/catalog/featured/:itemId` | â€” | âŒ | â€” |
| GET `/v1/admin/content/search` | â€” | âŒ | â€” |
| GET `/v1/admin/catalog/items/:itemId` | â€” | âŒ | â€” |
| PUT `/v1/admin/catalog/items/:itemId/lifecycle/schedule` | â€” | âŒ | â€” |
| POST `/v1/admin/catalog/items/:itemId/lifecycle/publish` | â€” | âŒ | â€” |
| POST `/v1/admin/catalog/items/:itemId/lifecycle/unpublish` | â€” | âŒ | â€” |
| POST `/v1/admin/catalog/items/:itemId/lifecycle/cancel` | â€” | âŒ | â€” |
| GET `/v1/admin/economics` | â€” | âŒ | â€” |
| PUT `/v1/admin/economics` | â€” | âŒ | â€” |
| GET `/v1/admin/markets/region-presets` | â€” | âŒ | â€” |
| PUT `/v1/admin/markets/region-presets` | â€” | âŒ | â€” |
| GET `/v1/admin/reporting` | â€” | âŒ | â€” |
| GET `/v1/admin/reporting/export` | â€” | âŒ | â€” |
| GET `/v1/admin/backorders/summary` | â€” | âŒ | â€” |
| GET `/v1/admin/backorders` | â€” | âŒ | â€” |
| GET `/v1/admin/revenue-splits` | â€” | âŒ | â€” |
| GET `/v1/admin/revenue-splits/:splitId` | â€” | âŒ | â€” |
| POST `/v1/admin/revenue-splits` | â€” | âŒ | â€” |
| PUT `/v1/admin/revenue-splits/:splitId` | â€” | âŒ | â€” |
| DELETE `/v1/admin/revenue-splits/:splitId` | â€” | âŒ | â€” |
| POST `/v1/admin/revenue-splits/preview` | â€” | âŒ | â€” |
| POST `/v1/admin/ledger/adjustment` | â€” | âŒ | â€” |

---

## 10) Payouts

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/admin/payouts/balances` | â€” | âŒ | â€” |
| GET `/v1/admin/payouts/pending` | â€” | âŒ | â€” |
| GET `/v1/admin/payouts/statements` | â€” | âŒ | â€” |
| GET `/v1/admin/payouts/batches` | â€” | âŒ | â€” |
| POST `/v1/admin/payouts/batch` | â€” | âŒ | â€” |
| POST `/v1/admin/payouts/scheduler/run` | â€” | âŒ | â€” |
| GET `/v1/admin/payouts/batches/:batchId/export` | â€” | âŒ | â€” |

---

## 11) Hardcopy & Backorders

| Endpoint | Consumer app | Admin app | Evidence (where found) |
|---|---:|---:|---|
| GET `/v1/hardcopy/availability/:bookId` | âŒ | âŒ | â€” |
| GET `/v1/hardcopy/partners/availability` | âŒ | âŒ | â€” |
| GET `/v1/hardcopy/backorder-offers` | âŒ | âŒ | â€” |
